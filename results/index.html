
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://francesco-vaselli.github.io/nfs/results/">
      
      
        <link rel="prev" href="../generation/">
      
      
        <link rel="next" href="../about/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.5">
    
    
      
        <title>Results - FlashSim</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.8608ea7d.min.css">
      
      
  
  
    
    
  
  
  <style>:root{--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 14h-2V9h2m0 9h-2v-2h2M1 21h22L12 2z"/></svg>');}</style>



    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#jets-results" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="FlashSim" class="md-header__button md-logo" aria-label="FlashSim" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            FlashSim
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Results
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/francesco-vaselli/FlashSim" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    francesco-vaselli/FlashSim
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="FlashSim" class="md-nav__button md-logo" aria-label="FlashSim" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    FlashSim
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/francesco-vaselli/FlashSim" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    francesco-vaselli/FlashSim
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../preprocessing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Preprocessing
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../trainings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Trainings
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../generation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Generation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Results
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Results
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#jets-results" class="md-nav__link">
    <span class="md-ellipsis">
      Jets Results
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Jets Results">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1d" class="md-nav__link">
    <span class="md-ellipsis">
      1D
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jets-correlations" class="md-nav__link">
    <span class="md-ellipsis">
      Jets correlations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#muons-results" class="md-nav__link">
    <span class="md-ellipsis">
      Muons results
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Muons results">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1d_1" class="md-nav__link">
    <span class="md-ellipsis">
      1D
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#correlations" class="md-nav__link">
    <span class="md-ellipsis">
      Correlations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conditioning" class="md-nav__link">
    <span class="md-ellipsis">
      Conditioning
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#speed" class="md-nav__link">
    <span class="md-ellipsis">
      Speed
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#results-on-unseen-processes" class="md-nav__link">
    <span class="md-ellipsis">
      Results on unseen processes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#benchmark-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Benchmark analysis
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Benchmark analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-higgs-decay-into-two-muons" class="md-nav__link">
    <span class="md-ellipsis">
      The Higgs decay into two muons
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#event-selection" class="md-nav__link">
    <span class="md-ellipsis">
      Event selection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-dnn-for-event-classification" class="md-nav__link">
    <span class="md-ellipsis">
      A DNN for event classification
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fullsim-vs-flashsim" class="md-nav__link">
    <span class="md-ellipsis">
      FullSim vs FlashSim
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flashsim-vs-gen" class="md-nav__link">
    <span class="md-ellipsis">
      FlashSim vs Gen
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#upsampling" class="md-nav__link">
    <span class="md-ellipsis">
      Upsampling
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#jets-results" class="md-nav__link">
    <span class="md-ellipsis">
      Jets Results
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Jets Results">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1d" class="md-nav__link">
    <span class="md-ellipsis">
      1D
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jets-correlations" class="md-nav__link">
    <span class="md-ellipsis">
      Jets correlations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#muons-results" class="md-nav__link">
    <span class="md-ellipsis">
      Muons results
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Muons results">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1d_1" class="md-nav__link">
    <span class="md-ellipsis">
      1D
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#correlations" class="md-nav__link">
    <span class="md-ellipsis">
      Correlations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conditioning" class="md-nav__link">
    <span class="md-ellipsis">
      Conditioning
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#speed" class="md-nav__link">
    <span class="md-ellipsis">
      Speed
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#results-on-unseen-processes" class="md-nav__link">
    <span class="md-ellipsis">
      Results on unseen processes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#benchmark-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Benchmark analysis
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Benchmark analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-higgs-decay-into-two-muons" class="md-nav__link">
    <span class="md-ellipsis">
      The Higgs decay into two muons
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#event-selection" class="md-nav__link">
    <span class="md-ellipsis">
      Event selection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-dnn-for-event-classification" class="md-nav__link">
    <span class="md-ellipsis">
      A DNN for event classification
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fullsim-vs-flashsim" class="md-nav__link">
    <span class="md-ellipsis">
      FullSim vs FlashSim
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flashsim-vs-gen" class="md-nav__link">
    <span class="md-ellipsis">
      FlashSim vs Gen
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#upsampling" class="md-nav__link">
    <span class="md-ellipsis">
      Upsampling
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



  <h1>Results</h1>

<p>This long section serves to present in a comprehensive way the results obtained.</p>
<p>To perform a sound and reasonable comparison, we extract the Gen-values for conditioning from <span class="arithmatex">\(10^{5}\)</span> t<span class="arithmatex">\(\overline{\text{t}}\)</span> samples coming from an unseen test set for jets and from the validation set (which was not used for training but just for evaluating the loss over time) for muons. We then generate new analysis samples using FlashSim and starting from the same Gen-values, to get a one-to-one correspondence between the them and FullSim samples.</p>
<p>We performed two main types of comparison on the obtained samples: we compared the 1-d <em>distribution</em> and the 2-d <em>correlations</em> for any pair of variables.
We inspected the latter visually thanks to <em>contour plots</em>, but we wanted to have a precise measure for the similarity of the empirical distributions between two samples. We thus choose the <em>Wasserstein distance</em>, defined as:</p>
<div class="arithmatex">\[W_1(u, v) = \inf_{\pi \in \Gamma(u, v)}\int_{\mathbb{R}\times\mathbb{R}}|x-y|d\pi(x,y) = \int_{-\infty}^{+\infty} |U - V|\]</div>
<p>where <span class="arithmatex">\(\Gamma(u, v)\)</span> is the set of (probability) distributions on <span class="arithmatex">\(\mathbb{R}\times\mathbb{R}\)</span> whose marginals are <span class="arithmatex">\(u\)</span> and <span class="arithmatex">\(v\)</span> on the first and second factors respectively, and <span class="arithmatex">\(U\)</span>, <span class="arithmatex">\(V\)</span> are the respective CDFs. Intuitively, if each distribution is viewed as a unit amount of earth (soil), the metric is the minimum <em>cost</em> of turning one pile into the other, which is assumed to be the amount of earth that needs to be moved times the mean distance it has to be moved, and thus this metric is also know informally as the <em>earth mover distance</em>.</p>
<h2 id="jets-results">Jets Results</h2>
<h3 id="1d">1D</h3>
<p>We show in the following figure four 1-d distributions out of the total of 17 target variables obtained for jets. We emphasize once more that the model actually learned to generate the 17 values simultaneously, preserving the correct correlations as well as producing convincing distribution.</p>
<p>Regarding the distributions, we observe that the model has correctly learned all the multi-modal, sharply peaked tagging distributions with Wasserstein scores of the order of <span class="arithmatex">\(0.001\)</span>, testifying good convergence. The log scale of btagDeepB actually shows an instance of <em>bridging</em>, where a small set of values were generated between two separate peaks. Single-mode distributions such as ptRatio have been larned as well, as were the Ids thanks to dequantization. The jetId outputs were rounded to the closest value between 0, 2 and 6, the only admissible ones.</p>
<p>Finally, we also observe a worse performance on two distributions: bRegCorr, a rather simple, skewed one-mode distribution which is expected to improve with further training (current Wasserstein distance is <span class="arithmatex">\(\approx\)</span> 0.02), and nConstituents. The latter result is probably in stronger disagreement because the target actually consists of integer values--as we discussed before, the NF approach expects continuous distributions, and so the model performs bridging in an attempt to obtain a reasonable continuous distribution. However, it has been observed in previous trainings for similar architectures that the model is actually capable of partially overcoming this limitation by brute force alone: if left in training for long enough it may eventually learn to output values close to the integer ones.</p>
<p><img alt="deepB" src="../img/eval3.pdf-1.jpg" />
<img alt="ptratio" src="../img/eval12.pdf-1.jpg" />
<img alt="jetid" src="../img/eval16.pdf-1.jpg" />
<img alt="nconst" src="../img/eval10.pdf-1.jpg" /></p>
<h3 id="jets-correlations">Jets correlations</h3>
<p>The correlations between jets variables, inspected visually, show good agreement with those from FullSim. The following figures shows the highly non-trivial correlations between the tagging distributions, with <em>quantiles</em> plotted at 0.5, 0.9, 0.99. The same choice for quantiles has been adopted for all the following figures.</p>
<p><img alt="corrjet1" src="../img/corrjet1.pdf-1.jpg" /></p>
<p>We can also observe in the following figures how the models have learned to capture the correlations between the qgl score, which is correctly correlated to the number of constituents as a lower number of constituents is expected for the u, d, s quarks when compared to gluons. Additionally, correlations between the physical p<span class="arithmatex">\(_T\)</span> and mass distributions, obtained from the original p<span class="arithmatex">\(_T\)</span>Ratio and massRatio outputs of the network, have been learned as well.</p>
<p><img alt="corrjet2" src="../img/corrjet2.pdf-1.jpg" />
<img alt="corrjet3" src="../img/corrjet3.pdf-1.jpg" /></p>
<h2 id="muons-results">Muons results</h2>
<h3 id="1d_1">1D</h3>
<p>For the muons, we obtained similar results--good, convincing general convergence and correlations apart from a subset of the target variables. It should be noted that a larger number of target variables for this case were actually Boolean Ids, and as discussed before were approached through dequantization. The following figures shows 4 distributions out of 22 target variables. Aside from good convergence on the firs two, we can observe that for a series of them, such as the impact parameters errors dxyErr and dzErr the training is complicated by the fact that the NanoAOD format stores the variables in a low-precision format: this is reflected by the jagged structure in the plot for FullSim and it causes the model to perform bridging to reach convergence.</p>
<p><img alt="mpt" src="../img/meval2.pdf-1.jpg" />
<img alt="mdxy" src="../img/meval4.pdf-1.jpg" />
<img alt="mdxyerr" src="../img/meval6.pdf-1.jpg" />
<img alt="softmva" src="../img/meval21.pdf-1.jpg" /></p>
<h3 id="correlations">Correlations</h3>
<p>Finally, as a last example of correlations, we show in the following that the model has actually learned to capture complex correlations such as the ones between the <em>impact parameter</em> ip3d and the quantity <span class="arithmatex">\(\sqrt{\texttt{dxy}^2 + \texttt{dz}^2}\)</span>, which is closely related to the definition of the impact parameter itself.</p>
<p><img alt="mcorr" src="../img/mcorrs.pdf-1.jpg" /></p>
<h2 id="conditioning">Conditioning</h2>
<p>Another extremely important feature of our approach is the desired ability to obtain specific results starting from certain Gen-level inputs, a characteristic we called conditioning. The idea is that we want to learn not just <span class="arithmatex">\(p^*_x(\mathbf{x})\)</span>, but <span class="arithmatex">\(p^*_x(\mathbf{x}|\text{Gen})\)</span>.</p>
<p>We can readily see that this is possible by focusing on specific results obtained for the jets model. The following shows that the final, NanoAOD level reconstructed p<span class="arithmatex">\(_T\)</span> is correctly correlated to the GenJet p<span class="arithmatex">\(_T\)</span> for both FullSim and FlashSim: as we would expect the Gen-p<span class="arithmatex">\(_T\)</span> is crucial in determining the final-state p<span class="arithmatex">\(_T\)</span>. What is more, in the same figure we also show the <em>profile histogram</em> and RMS (<span class="arithmatex">\(\sigma_{p_T}\)</span>/p<span class="arithmatex">\(_T\)</span>) for the GenJet p<span class="arithmatex">\(_T\)</span> versus the p<span class="arithmatex">\(_T\)</span>Ratio. As expected, not only does the p<span class="arithmatex">\(_T\)</span>Ratio decrease as the GenJet p<span class="arithmatex">\(_T\)</span> increases (highly energetic jets have a reconstructed p<span class="arithmatex">\(_T\)</span> closer to the Gen-value), but the RMS correctly decreases as well, as constant terms in the p<span class="arithmatex">\(_T\)</span> resolution due to pile-up are divided by bigger terms as GenJet p<span class="arithmatex">\(_T\)</span> increases.</p>
<p><img alt="corjet4" src="../img/corrjet4.pdf-1.jpg" />
<img alt="profhist" src="../img/profhist.pdf-1.jpg" /></p>
<p>Additionally, because the partonFlavour conditioning variable allow us to specify the quark content of a jet, we can study how related quantities depend on this input. As a key example, we study the behaviour of the btagDeepB b-tagging distribution as we vary the parton input for the jet generation. The next figures show how the distribution changes according to the ground truth value specified as input: as expected, jets being conditioned with a b content present higher values of b-tagging, with a sharp peak at one, while those coming from u, d, s are clearly peaked around smaller values. Now we could think of defining a threshold and assign a reconstructed b content to all those jets higher than that value. We would naturally mistag some events, leading us to define a <em>flase-positive</em> ratio and a <em>true-positive</em> one. A standard figure of merit for these cases is the <em>Receiving operating characteristic</em> (ROC) curve, which plots the TPR against the FPR for all possible threshold choices. The last figure shows it for our model in log scale, showing minimal deviations from the target FullSim curve.</p>
<p><img alt="btagj" src="../img/btagj.pdf-1.jpg" />
<img alt="roc1" src="../img/rocj1.png" /></p>
<p>Because our results are not as close to FullSim as it was for 2-d correlations, we would like to compare them with other competing approaches to asses the goodness of our own methodology. In order to do so, for a previous training with a lower number of jet target variables, presented at the CMS Machine learning Forum of April 2022, we compared the ROC curves between FullSim, FastSim and FlashSim on a <span class="arithmatex">\(10^{6}\)</span> t<span class="arithmatex">\(\overline{\text{t}}\)</span> samples set (not previously seen during training). Results are shown in the next Figure. We can see that while the ROC between our approach and FullSim is actually indistiguishable for TPR higher than 0.8, the FastSim ROC completely <em>overshoots</em> the target, due to oversimplifications in the simulation approach. With longer training times and additional loss terms addressing this type of conditioning, which is currently not considered by the model loss function, we are confident that the performance of FlashSim could be improved even more.</p>
<p><img alt="allrocs" src="../img/allrocs.pdf-1.jpg" /></p>
<h2 id="speed">Speed</h2>
<p>A crucial result obtained is the <em>generation speed</em>: for both jets and muons we managed to generate samples in batches of <span class="arithmatex">\(10^{4}\)</span> in <span class="arithmatex">\(\approx\)</span> 0.3 seconds each, corresponding to a generation speed of raw samples of about 33,300 <em>samples per second</em> (33 kHz) <em>meaning a six orders of magnitude speedup when compared to FullSim and four orders of magnitude speedup when compared to FastSim</em>! Even considering possible reduction due to preprocessing and data loading, this result testify to the potential of the current methodology to completely redefine our approach to event simulation, at least at the NanoAOD level.</p>
<p>What is more, the <span class="arithmatex">\(10^{4}\)</span> batch size for generation was limited only by the VRAM of the GPU being used, meaning that more powerful GPUs, ideally working in parallel, could achieve even faster generation times.</p>
<h2 id="results-on-unseen-processes">Results on unseen processes</h2>
<p>We actually extended the use of the models to <em>unseen, different physical processes</em>: <em>Drell-Yan two-jets</em> (DY), <em>Electroweak two-muons two-jets</em> (EWK LLJJ) and two <em>Signal</em> (H<span class="arithmatex">\(\rightarrow\mu^+\mu^-\)</span>) datasets were processed as well and stored for the comparison of the next chapter. Some results, are showed below and emphasize how our approach has correctly learned to simulate the interaction and reconstruction of the CMS detector, giving consistent results independently from the input process.</p>
<p><img alt="ewk" src="../img/ewkeval7.pdf-1.jpg" />
<img alt="hmm" src="../img/hmmeval2.pdf-1.jpg" />
<img alt="dy" src="../img/dycorrs.pdf-1.jpg" /></p>
<h2 id="benchmark-analysis">Benchmark analysis</h2>
<p>Having described in detail our innovative approach to event simulation, and having applied it to generated events for which we have the FullSim sample, we decided to repeat the basic steps of a recent analysis to demonstrate the feasibility of our model in a real-case scenario.</p>
<h3 id="the-higgs-decay-into-two-muons">The Higgs decay into two muons</h3>
<p>We generated a FlashSim dataset from the Gen-level information of the existing NanoAOD FullSim datasets for the different processes discussed before, that is:</p>
<ol>
<li>The t<span class="arithmatex">\(\overline{\text{t}}\)</span> inclusive production (also used in training);</li>
<li>The DY+2J process;</li>
<li>The EWK production of <span class="arithmatex">\(\mu\mu\)</span>+2J;</li>
<li>The Higgs VBF production, with the Higgs decaying into pairs of <span class="arithmatex">\(\mu\)</span>.</li>
</ol>
<p>We then performed the preliminary selection steps of the analysis presented in the <a href="https://link.springer.com/article/10.1007/JHEP01(2021)148" title="Full Analysis">analysis</a>, specifically that of VBF Channel of H<span class="arithmatex">\(\rightarrow\mu^+\mu^-\)</span>, for the reasons discussed previously.
The objective was to verify that the selected objects distributions were close enough to those obtained from FullSim.</p>
<h3 id="event-selection">Event selection</h3>
<p>First of all, we select muons as follows:</p>
<ol>
<li>pfRelIso04_all<span class="arithmatex">\(= \sum_{\Delta R(PF_i, \mu)&lt;0.4}p_T^i/p_T^{\mu}&lt;0.25\)</span> (isolated);</li>
<li>Muons passing the \emph{medium} muon Id algorithm;</li>
<li><span class="arithmatex">\(p_T^{\mu}&gt;20\)</span> GeV;</li>
<li><span class="arithmatex">\(|\eta_{\mu}|&lt;2.4\)</span>.</li>
</ol>
<p>These are all features we would expect from a pair of muons decaying from a Higgs. An event is also required to have at least two opposite charged muons.</p>
<p>In a similar way, we select the jets as those passing the following cuts:</p>
<ol>
<li><span class="arithmatex">\(p_T^{jet}&gt;25\)</span> GeV </li>
<li>Additionally, for <span class="arithmatex">\(p_T^{jet}&lt;50\)</span> GeV we require it to pass the pile-up Id algorithm;</li>
<li>Jets passing the <em>jet</em> Id algorithm;</li>
<li><span class="arithmatex">\(|\eta_{jet}|&lt;4.7\)</span>;</li>
<li>We also require that jets do not overlap with muons within a <span class="arithmatex">\(\Delta R\leq0.4\)</span> cone.</li>
</ol>
<p>A VBF candidate event is required to have at least two jets respecting the previous properties, one with <span class="arithmatex">\(p_T&gt;35\)</span> GeV, the other with <span class="arithmatex">\(p_T&gt;25\)</span> GeV, an invariant mass of the leading jet pair <span class="arithmatex">\(m_{jj}&gt;400\)</span> GeV and a separation between the leading jets of <span class="arithmatex">\(\Delta\eta&gt;2.5\)</span>. Selected events are further grouped into two independent categories. Events in which the two muons form an invariant mass between 115 and
135 GeV belong to the signal region (VBF-SR), which is enriched in signal-like events. Events with 110 &lt; <span class="arithmatex">\(m_{\mu\mu}\)</span> &lt; 115 GeV or 135 &lt; <span class="arithmatex">\(m_{\mu\mu}\)</span> &lt; 150 GeV belong to the mass sideband region (VBF-SB), which in the full analysis has been used as a control region to estimate the backgroung.</p>
<p>For each selected event we define the new, derived quantities that help discriminating the Higgs signal from the SM processes that represent a background for this analysis. Some crucial ones are:</p>
<ol>
<li>The reconstructed <em>Higgs-candidate</em>, with a 4-momentum given by the sum of the two four-vectors of the selected muons;</li>
<li>Observables sensitive to <span class="arithmatex">\(p_T\)</span> and angular correlations between muons and jets: </li>
</ol>
<p>The <span class="arithmatex">\(p_T\)</span><em>-balance ratio</em>, defined as:</p>
<div class="arithmatex">\[
R(p_T) = \frac{|\mathbf{p_T}^{jj}+\mathbf{p_T}^{\mu\mu}|}{p_T(j_1) + p_T(j_2) + p_T^{\mu\mu}}
\]</div>
<p>and the <em>Zeppenfeld variable</em> <span class="arithmatex">\(z^*\)</span>, defined from the <em>rapidity y</em> as:</p>
<div class="arithmatex">\[z^* = \frac{y_{\mu\mu} - (y_{j_1} + y_{j_2})/2}{|y_{j_1} - y_{j_2}|}\]</div>
<ol>
<li>The azimuthal angle (<span class="arithmatex">\(\phi_{CS}\)</span>) and the cosine of the polar angle (<span class="arithmatex">\(\cos\theta_{CS}\)</span>) computed in the dimuon <em>Collinsâ€“Soper</em> rest frame.</li>
</ol>
<p>The next Figure shows the <span class="arithmatex">\(R(p_T)\)</span> and the <span class="arithmatex">\(\log(z^*)\)</span> for the Signal and the DY Background process, emphasizing how these quantities can be used to discriminate between the two. The Figure also introduces the FullSim vs FlashSim comparison and will be referenced again in the following.</p>
<p><img alt="dycomp" src="../img/DY2Jets_vs_HMM_powheg_Rpt___SignalRegion_log_normalizedc2.pdf-1.jpg" />
<img alt="dycompz" src="../img/DY2Jets_vs_HMM_powheg_ll_zstar_log___PreSel_log_normalized.pdf-1.jpg" /></p>
<h3 id="a-dnn-for-event-classification">A DNN for event classification</h3>
<p>The CMS Collaboration used a deep neural network (DNN) multivariate discriminant, trained to distinguish the expected signal from background events using kinematic input variables that characterize the signal and the main background processes in the VBF-SR. The signal is then extracted from a <em>binned maximum-likelihood fit</em> to the output of the DNN discriminator simultaneously in the VBF-SR and the VBF-SB regions. </p>
<p>The DNN used in the final analysis has been tested on the FlashSim samples, with the final weights and parameters resulting from the trainings already performed by the authors of the original paper on the FullSim dataset. We tested the network on our FlashSim data to compare the ouput with the one on the FullSim datasets used in the analysis and taken as Gen-level truth for generating our samples.</p>
<p>The network takes as input 25 variables. The first 23 are listed below:</p>
<ol>
<li>
<p>Six variables associated with production and decay of the dimuon pair: its mass <span class="arithmatex">\(m_{\mu\mu}\)</span>, the absolute and relative mass resolutions <span class="arithmatex">\(\Delta m_{\mu\mu}\)</span>, <span class="arithmatex">\(\Delta m_{\mu\mu}/m_{\mu\mu}\)</span>, its momentum <span class="arithmatex">\(p_T^{\mu\mu}\)</span> and its logarithm, the pseudorapidity <span class="arithmatex">\(\eta_{\mu\mu}\)</span>;</p>
</li>
<li>
<p>The azimuthal angle (<span class="arithmatex">\(\phi_{CS}\)</span>) and the cosine of the polar angle (<span class="arithmatex">\(\cos\theta_{CS}\)</span>), the <span class="arithmatex">\(p_T\)</span>\emph{-balance ratio} <span class="arithmatex">\(R(p_T)\)</span> and the logarithm of the <em>Zeppenfeld variable</em> <span class="arithmatex">\(z^*\)</span>;</p>
</li>
<li>
<p>The vector components of the leading jets, <span class="arithmatex">\(p_T(j_1)\)</span>, <span class="arithmatex">\(\eta(j_1)\)</span>, <span class="arithmatex">\(\phi(j_1)\)</span>, <span class="arithmatex">\(p_T(j_2)\)</span>, <span class="arithmatex">\(\eta(j_2)\)</span>, <span class="arithmatex">\(\phi(j_2)\)</span>, and their QGL scores, <span class="arithmatex">\(QGL(j_1)\)</span>, <span class="arithmatex">\(QGL(J_2)\)</span>, since jets in signal events are expected to originate from quarks, whereas in the DY process they can also be initiated by gluons;</p>
</li>
<li>
<p>Key variables referring to the dijet system: its mass <span class="arithmatex">\(m_{jj}\)</span> and <span class="arithmatex">\(\log(m_{jj})\)</span>, the pseudorapidity distance between the two jets <span class="arithmatex">\(\Delta \eta_{jj}\)</span>;</p>
</li>
<li>
<p>The minimum distance in pseudorapidity of the Higgs candidate with the two leading jets <span class="arithmatex">\(\min(\eta(\mu\mu, j_1),\eta(\mu\mu, j_2))\)</span>;</p>
</li>
<li>
<p>The data taking year (set to 2018 for both FullSim and FlashSim samples).</p>
</li>
</ol>
<p>Additionally, the VBF signal events are expected to have suppressed hadronic activity in the rapidity gap between the two leading jets. This feature is exploited by considering <em>soft jets</em> in the event that are defined by clustering, via the <em>anti-</em><span class="arithmatex">\(k_T\)</span> jet-clustering algorithm with a distance parameter of 0.4, charged particles from the primary interaction vertex excluding the two identified muons and those associated with the two VBF jets. The soft jets are required to have <span class="arithmatex">\(p_T&gt;5\)</span> GeV. The number of soft jets in an event, <span class="arithmatex">\(N^{\text{soft}}_5\)</span>, as well as the scalar sum of their transverse momenta, <span class="arithmatex">\(H^{\text{soft}}_{(2)T}\)</span>, are used as additional input variables. 
Because soft activity depends upon the presence of additional charged particles, which we have not simulated in the present FlashSim prototype, we resorted to fixing the values of these two variables to <span class="arithmatex">\(N^{\text{soft}}_5=0\)</span> and <span class="arithmatex">\(H^{\text{soft}}_{(2)T}=1.0\)</span> GeV. As we are interested in performing a comparison of the DNN output for FullSim and FlashSim, using fixed values in the evaluation of both does not bias the results.</p>
<h3 id="fullsim-vs-flashsim">FullSim vs FlashSim</h3>
<p>We observe good results on distributions directly related to the simulated targets of FlashSim. The next Figure shows the pfRelIso_04_all for lead muons passing the initial selection, which presents small deviations when compared to the FullSim sample, despite the lower number of FlashSim muons passing the selection. The bottom panel shows the ratio between the FlashSim and the FullSim sample, were the chosen convention here and in the following has been to always divide by the FullSim.</p>
<p><img alt="ewpresel" src="../img/EWK_LLJJ_LeadMuon_pfRelIso04_all___PreSel_log.pdf-1.jpg" /></p>
<p>However, for jets, the agreement is not as good as for muons. The next figure shows that the <span class="arithmatex">\(p_T\)</span> for the second selected jet is not as high for FlashSim jets as it is for FullSim ones. We tried to explain this result by remembering that our current prototype of FlashSim is missing <em>fakes</em> jets due to noise and pile-up, present in the other sample. In principle, higher-<span class="arithmatex">\(p_T\)</span> fake jets may be selected in place of the second event jet for some of the FullSim samples, explaining the deviation observed. In fact, fake jets have usually low-<span class="arithmatex">\(p_T\)</span>, under 50 GeV, and we can see that our distribution is perfectly overlapping at high-<span class="arithmatex">\(p_T\)</span>.</p>
<p><img alt="ttpresel" src="../img/TTJets_J1_pt____log.pdf-1.jpg" /></p>
<p>The results related to angular distributions also show a good performance. We showed above how the histograms for the <span class="arithmatex">\(R(p_T)\)</span> and the <span class="arithmatex">\(\log(z^*)\)</span>  of the Higgs vs DY processes, to show how these variables can be <em>discriminant</em> in distinguishing between signal and background. At the same time, we can see how FlashSim correctly reproduces the Signal versus Background differences.</p>
<p>We also show the outputs of the VBF DNN discriminator network for each single process, which was used as the fit function for the real analysis. The FlashSim predictions are still very close to the FullSim ones, a crucial result for assessing the potential for real-world analysis applications.</p>
<p><img alt="ttdnn" src="../img/TTJets_DNN18Atan___SignalRegion_log.pdf-1.jpg" /> 
<img alt="ewkdnn" src="../img/EWK_LLJJ_DNN18Atan___SignalRegion_log.pdf-1.jpg" />
<img alt="dydnn" src="../img/DY2Jets_DNN18Atan___SignalRegion_log.pdf-1.jpg" />
<img alt="powdnn" src="../img/HMM_powheg_DNN18Atan___SignalRegion_log.pdf-1.jpg" />
<img alt="amcdnn" src="../img/HMM_amcatnlo_DNN18Atan___SignalRegion_log.pdf-1.jpg" /></p>
<p>An even greater accuracy may be obtained when a FullSim sample is already available and we need alternative samples for estimating systematic uncertainties, e.g.  different <em>theoretical variations</em> for the same process. This is the case, for example, for the two samples of the Higgs signal, which differ in the theoretical technique employed for <em>systematic inclusion of higher order QCD effects</em>: one employed the <em>POWHEG</em> software, the other the <em>MadGraph5_aMC@NLO</em> one. Suppose we had a FullSim reference sample <span class="arithmatex">\(REF_{Full}\)</span>, we computed its FlashSim <span class="arithmatex">\(REF_{Flash}\)</span> sample as well as that of another possible variation <span class="arithmatex">\(VAR_{Flash}\)</span>. We would expect that the actual <span class="arithmatex">\(VAR_{Full}\)</span> may be re-obtained faster than a run of FullSim by the factorization:</p>
<div class="arithmatex">\[VAR_{Full} = REF_{Full} \frac{VAR_{Flash}}{REF_{Flash}}
\]</div>
<p>as the ratio factors out the FlashSim differences and leaves out only the software sample differences which are then multiplied by the <span class="arithmatex">\(REF_{Full}\)</span> sample. The following Figure shows that our expectations are met by the FlashSim approach, as the aMC@NLO FullSim variation sample agrees with the ratio calculated from the POWHEG variation sample and the aMC@NLO FlashSim sample. This opens up the way to fast calculations of theoretical variations starting only from a single, pre-existing FullSim sample, implying a considerable speed-up when compared to re-starting always from Gen-level, as it is currently the case.</p>
<p><img alt="sys" src="../img/systematic_production.pdf-1.jpg" /></p>
<h3 id="flashsim-vs-gen">FlashSim vs Gen</h3>
<p>In order to better understand the added value of FlashSim, we can compare its output to what could be achieved by working directly at the Gen-level. Part of the chosen selection analysis objects may in fact be computed starting from Gen-level information alone, and thus we can ask ourselves if the FlashSim results are significantly different from those obtained with its inputs, the Gen values. In the following, we compare results for the Signal sample considering the three samples of FullSim, FlashSim and Gen.</p>
<p>For the <span class="arithmatex">\(\log(z^*)\)</span> angular distribution, as the angular resolution is already good at Gen level, and the next figure shows no significant deviations between the three samples. On the other hand, it should be noted that the fraction of events passing the selection (i.e. the integral of the plot) is much better reproduced in FlashSim than at Gen-level.</p>
<p><img alt="llz" src="../img/gen_vs_flash_ll_zstar_log___PreSel_log.pdf-1.jpg" /></p>
<p>However, as we move to the <span class="arithmatex">\(R(p_T)\)</span>, which depends on the hadronic activity, and thus on the effect of the interaction and reconstruction in the detector, we see the expected differences, as plotted below:</p>
<p><img alt="rptg" src="../img/gen_vs_flash_Rpt___PreSel_log.pdf-1.jpg" /></p>
<p>Additionally, the importance of the interaction with the detector and of the reconstruction, leading to <em>smearing</em> in the distribution of the dimuon mass, is emphasized by the next figure, where we can see that the Gen has only a single, peaked value, while FlashSim has correctly learned the expected smearing.</p>
<p><img alt="hmmg" src="../img/gen_vs_flash_Higgs_m___PreSel_log.pdf-1.jpg" /></p>
<p>Finally, this differences also translate to the distribution of the VBF DNN Output, which is the fitted observable in the final analysis, shown below:</p>
<p><img alt="dnng" src="../img/gen_vs_flash_DNN18Atan_noqgl___PreSel_log.pdf-1.jpg" /></p>
<h2 id="upsampling">Upsampling</h2>
<p>Because the simulation and reconstruction steps are currently much slower than the generation one, when working with FullSim the default choice is to employ a different Gen-level event for each passing through simulation and reconstruction, to maximize the information contained in the final dataset. As our proposed FlashSim has demonstrated significant speed improvements, we decided to experiment with <em>upsampling</em>; i.e. generating multiple final-state, NanoAOD-format events from the same Gen-level information. In practice, due to the stochasticity of the simulation step, we are computing the pdf of the reconstructed events for each Gen-event. </p>
<p>The next Figureshows this is indeed the case: if we generate 10,000 events from the same Signal POWHEG Gen-level value we observe a distribution spread around the single value returned from the conventional, 1-to-1 FlashSim approach, at least for those variables having a strong dependency on experimental resolution, such as the VBF DNN Output. The <span class="arithmatex">\(\log(z^*)\)</span> is instead sharply peaked around the FullSim value, as it is very precisely reconstructed, hence the simulation+reconstruction value is very close to the generated one. The stochasticity introduced by the Sim step is closely related to the selected variable, and we expect more significant advantages for those variables presenting a good spreading.
  It is also interesting to note that out of the 10,000 generated events only 7,633 pass the analysis selection and are being used to plot the VBF DNN Output distribution.</p>
<p><img alt="ll1u" src="../img/1upsampled_HMM_amcatnlo_ll_zstar_log___SignalRegion_log_norm.pdf-1.jpg" />
  <img alt="hm1u" src="../img/1upsampled_HMM_amcatnlo_DNN18Atan___SignalRegion_log_norm.pdf-1.jpg" /></p>
<p>The capacity for upsampling offers some important advantages. First of all, if FlashSim is capable of running at 33 kHz, the Gen production is becoming our bottleneck, hence reusing the Gen implies additional resource savings. Additionally, because we are generating more data, we can expect a reduction of the statistical error; however we must correctly compute the uncertainties in this case.</p>
<p>Usually, if we are interested in finding the discrete <em>pdf</em> from an histogram, assuming a <em>poisson</em> statistics the pdf <em>i</em>-th bin and its error are defined as:</p>
<div class="arithmatex">\[
  pdf_i = \frac{\sum_{ev \in i}{w_{ev}}}{\sum_{ev}{w_{ev}}}; \quad 
      \sigma_i = \frac{\sqrt{\sum_{ev \in i}{w_{ev}^2}}}{\sum_{ev}{w_{ev}}}
\]</div>
<p>Where the <em>w</em>s are the weights for each event and they are typically set to 1.
   In the upsampling case instead, we have N upsampled events with a common Gen-event (called <em>folds</em>), and thus we obtain:</p>
<div class="arithmatex">\[
pdf_i = \frac{\sum_{ev}\sum_{fold\in i}{w_{ev}}}{N_{fold}\sum_{ev}{w_{ev}}} = \frac{\sum_{ev}\sum_{fold\in i}{w_{ev}/N_{fold}}}{\sum_{ev}{w_{ev}}} =
\frac{\sum_{ev}{w_{ev}pdf_i^{ev}}}{\sum_{ev}{w_{ev}}}
\]</div>
<p>That is, each event may now enter multiple bins as it has been upsampled by a factor N--this is the same as saying that we can sum the pdf of each single event to obtain the final pdf. For the errors we consider folds from the same events entering different bins as uncorrelated, with a weight proportional to the number of folds entering the same bin. By recovering the initial error formula we get:</p>
<div class="arithmatex">\[
\sigma_i = \frac{\sqrt{\sum_{ev}(\sum_{fold\in i}{w_{ev}/N_{fold})^2}}}{\sum_{ev}{w_{ev}}} =
  \frac{\sqrt{\sum_{ev}{(w_{ev}pdf_i^{ev})^2}}}{\sum_{ev}{w_{ev}}}
\]</div>
<p>Practically speaking, for each event, we let the N upsampled events fill the histogram, and then defined the pdf of a single event as (bin content)/N, a quantity also used for determining the new statistical error. The resulting pdfs are then summed together to obtain the final histogram. This procedure is necessary to ensure that we are properly accounting for upsampled events filling the same bin--e.g. we want to have no difference between the 1-to-1 approach and the case where all events fill the same bin.</p>
<p>As already discussed, we expect a greater reduction of the errors for those variables heavily influenced by the interaction with the detector.</p>
<p>The following figure shows the comparison for the Signal POWHEG VBF DNN Output between the 1-to-1 FlashSim and the FlashSim upsampled by a factor of 25, whose histogram was filled with the empirical pdfs as described above. The mean statistical error (defined as the mean for the square of the sum of weights squared) is 32.3 for the first case, which gets reduced to 14.2 for the upsampled dataset; approximately by a factor of <span class="arithmatex">\(1/2\)</span>. The relative error, defined as the error per bin divided by the bin content, is also showed in the first lower panel and is clearly decreasing across all bins, while the ratio is approximately one, as expected. For variables reconstructed with very high resolution, i.e. when the simulation+reconstruction does not introduce any significant smearing, such as <span class="arithmatex">\(\log(z^*)\)</span>, we observe a smaller error reduction (11.2 from 14.4), as expected.</p>
<p><img alt="hmmup" src="../img/HMM_powheg_DNN18Atan____log_upsampled.pdf-1.jpg" />
  <img alt="llup" src="../img/HMM_powheg_ll_zstar_log____log_upsampled.pdf-1.jpg" /></p>
<p>Another important advantage is that we may be able to obtain more smooth, convincing distributions for those cases where the low number of events is a limiting factor. One of such cases is the VBF DNN Output for the DY 2Jets dataset, which has high errors and a jagged distribution as only a tiny fraction of events pass the selection.</p>
<p>By performing an upsampling by a factor of 25 and comparing the results, we immediately see below that the resulting upsampled VBF DNN Output distribution not only has lower errors, but also manages to produce a more smoothly decreasing and convincing distribution, without the jagged peaks given by the small sample size of the 1-to-1 case.</p>
<p><img alt="dyup" src="../img/DY2Jets_DNN18Atan____log_upsampled.pdf-1.jpg" /></p>
<p>The results of the present Chapter demonstrate that not only is FlashSim capable of producing different distributions from those of the bare Gen-level, but also that it can come close to the results yield by FullSim. Additionally, it can fully make use of Gen-level information through the upsampling procedure.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.f1b6f286.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>